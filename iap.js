(function(){const KEY='phuketmunch_profile';function load(){try{return JSON.parse(localStorage.getItem(KEY))||{diamonds:50,best:0};}catch(e){return{diamonds:50,best:0};}}function save(p){localStorage.setItem(KEY,JSON.stringify(p));}window.IAP={getDiamonds(){return load().diamonds;},addDiamonds(n){const p=load();p.diamonds+=n;save(p);return p.diamonds;},spendDiamonds(n){const p=load();if(p.diamonds>=n){p.diamonds-=n;save(p);return true;}return false;},setBest(s){const p=load();if(s>p.best){p.best=s;save(p);}},getBest(){return load().best;},purchaseIAP(pack){const q={small:100,medium:500,large:2000}[pack]||0;return new Promise(res=>setTimeout(()=>res(IAP.addDiamonds(q)),600));}}})();